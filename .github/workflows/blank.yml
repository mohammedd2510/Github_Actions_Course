name: Full Variables & Secrets Demo

on:
  push:
# -------------------------------
# WORKFLOW-LEVEL variables
# Available to all jobs unless overridden
# -------------------------------
env:
  APP_NAME: workflow-app
  ENVIRONMENT: production
  OWNER: workflow-owner

jobs:
  demo:
    runs-on: ubuntu-latest

    # -------------------------------
    # JOB-LEVEL variables
    # Overrides workflow env
    # -------------------------------
    env:
      ENVIRONMENT: job-env      # overrides workflow
      DB_HOST: job-database
      OWNER: job-owner          # overrides workflow

    steps:
      - name: Show workflow/job variables
        run: |
          echo "APP_NAME=$APP_NAME"        # workflow-level
          echo "ENVIRONMENT=$ENVIRONMENT"  # job-level overrides workflow
          echo "DB_HOST=$DB_HOST"          # job-level
          echo "OWNER=$OWNER"              # job-level overrides workflow

      - name: Step-level env example
        env:
          OWNER: step-owner              # highest precedence
          VERSION: 10.5
        run: |
          echo "OWNER=$OWNER"             # step-level
          echo "VERSION=$VERSION"
          echo "APP_NAME still accessible = $APP_NAME"

      - name: Repository variable example
        run: |
          echo "Repository variable API_URL = ${{ vars.API_URL }}"

      - name: Secrets example 
        run: |
          echo "API_KEY = ${{ secrets.API_KEY }}"


      - name: Variable precedence demo
        env:
          ENVIRONMENT: step-env   # step-level overrides everything
        run: |
          echo "Step-level ENVIRONMENT = $ENVIRONMENT"
          echo "Job-level DB_HOST = $DB_HOST"
          echo "Workflow-level APP_NAME = $APP_NAME"
          echo "OWNER variable = $OWNER"   # still job-level since step-level not defined

      - name: Show GitHub default variables
        run: |
          echo "GITHUB_REPOSITORY=$GITHUB_REPOSITORY"
          echo "GITHUB_ACTOR=$GITHUB_ACTOR"
          echo "GITHUB_WORKFLOW=$GITHUB_WORKFLOW"
          echo "GITHUB_RUN_ID=$GITHUB_RUN_ID"
          echo "GITHUB_RUN_NUMBER=$GITHUB_RUN_NUMBER"
          echo "GITHUB_JOB=$GITHUB_JOB"
          echo "GITHUB_SHA=$GITHUB_SHA"
